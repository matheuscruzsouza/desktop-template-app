var Neutralino=function(a){"use strict";function t(b,c,a,d){return new(a||(a=Promise))(function(f,g){function h(a){try{e(d.next(a))}catch(b){g(b)}}function i(a){try{e(d.throw(a))}catch(b){g(b)}}function e(b){var c;b.done?f(b.value):((c=b.value)instanceof a?c:new a(function(a){a(c)})).then(h,i)}e((d=d.apply(b,c||[])).next())})}function h(a,b){let c=new CustomEvent(a,{detail:b});return window.dispatchEvent(c),Promise.resolve({success:!0,message:"Message dispatched"})}let u,v={},w=[],x={};function y(a,b){return new Promise((c,d)=>{if((null==u?void 0:u.readyState)!=WebSocket.OPEN){z({method:a,data:b,resolve:c,reject:d});return}let e=C(),f=B();v[e]={resolve:c,reject:d},u.send(JSON.stringify({id:e,method:a,data:b,accessToken:f}))})}function z(a){w.push(a)}function A(a){return t(this,void 0,void 0,function*(){for(;a.length>0;){let b=a.shift();try{let c=yield y(b.method,b.data);b.resolve(c)}catch(d){b.reject(d)}}})}function B(){return window.NL_TOKEN||sessionStorage.getItem("NL_TOKEN")||""}function C(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(a^crypto.getRandomValues(new Uint8Array(1))[0]&15>>a/4).toString(16))}function D(b){let c=new Uint8Array(b),a="";for(let d of c)a+=String.fromCharCode(d);return window.btoa(a)}var d,e,f,c,b,i=Object.freeze({__proto__:null,createDirectory:function(a){return y("filesystem.createDirectory",{path:a})},removeDirectory:function(a){return y("filesystem.removeDirectory",{path:a})},writeFile:function(a,b){return y("filesystem.writeFile",{path:a,data:b})},appendFile:function(a,b){return y("filesystem.appendFile",{path:a,data:b})},writeBinaryFile:function(a,b){return y("filesystem.writeBinaryFile",{path:a,data:D(b)})},appendBinaryFile:function(a,b){return y("filesystem.appendBinaryFile",{path:a,data:D(b)})},readFile:function(a){return y("filesystem.readFile",{path:a})},readBinaryFile:function(a){return new Promise((b,c)=>{y("filesystem.readBinaryFile",{path:a}).then(f=>{let c=window.atob(f),d=c.length,e=new Uint8Array(d);for(let a=0;a<d;a++)e[a]=c.charCodeAt(a);b(e.buffer)}).catch(a=>{c(a)})})},removeFile:function(a){return y("filesystem.removeFile",{path:a})},readDirectory:function(a){return y("filesystem.readDirectory",{path:a})},copyFile:function(a,b){return y("filesystem.copyFile",{source:a,destination:b})},moveFile:function(a,b){return y("filesystem.moveFile",{source:a,destination:b})},getStats:function(a){return y("filesystem.getStats",{path:a})}});(c=d||(d={})).WARNING="WARNING",c.ERROR="ERROR",c.INFO="INFO",c.QUESTION="QUESTION",(b=e||(e={})).OK="OK",b.OK_CANCEL="OK_CANCEL",b.YES_NO="YES_NO",b.YES_NO_CANCEL="YES_NO_CANCEL",b.RETRY_CANCEL="RETRY_CANCEL",b.ABORT_RETRY_IGNORE="ABORT_RETRY_IGNORE";var g,j=Object.freeze({__proto__:null,get Icon(){return d},get MessageBoxChoice(){return e},execCommand:function(a,b){return y("os.execCommand",Object.assign({command:a},b))},spawnProcess:function(a){return y("os.spawnProcess",{command:a})},updateSpawnedProcess:function(a,b,c){return y("os.updateSpawnedProcess",{id:a,event:b,data:c})},getSpawnedProcesses:function(){return y("os.getSpawnedProcesses")},getEnv:function(a){return y("os.getEnv",{key:a})},showOpenDialog:function(a,b){return y("os.showOpenDialog",Object.assign({title:a},b))},showFolderDialog:function(a){return y("os.showFolderDialog",{title:a})},showSaveDialog:function(a,b){return y("os.showSaveDialog",Object.assign({title:a},b))},showNotification:function(a,b,c){return y("os.showNotification",{title:a,content:b,icon:c})},showMessageBox:function(a,b,c,d){return y("os.showMessageBox",{title:a,content:b,choice:c,icon:d})},setTray:function(a){return y("os.setTray",a)},open:function(a){return y("os.open",{url:a})},getPath:function(a){return y("os.getPath",{name:a})}}),k=Object.freeze({__proto__:null,getMemoryInfo:function(){return y("computer.getMemoryInfo")}}),l=Object.freeze({__proto__:null,setData:function(a,b){return y("storage.setData",{key:a,data:b})},getData:function(a){return y("storage.getData",{key:a})}});(g=f||(f={})).WARNING="WARNING",g.ERROR="ERROR",g.INFO="INFO";var m=Object.freeze({__proto__:null,get LoggerType(){return f},log:function(a,b){return y("debug.log",{message:a,type:b})}}),n=Object.freeze({__proto__:null,exit:function(a){return y("app.exit",{code:a})},killProcess:function(){return y("app.killProcess")},restartProcess:function(a){return new Promise(b=>t(this,void 0,void 0,function*(){let c=window.NL_ARGS.reduce((a,b)=>a+=" "+b,"");(null==a?void 0:a.args)&&(c+=" "+a.args),yield Neutralino.os.execCommand(c,{background:!0}),Neutralino.app.exit(),b()}))},getConfig:function(){return y("app.getConfig")},broadcast:function(a,b){return y("app.broadcast",{event:a,data:b})}});let E=new WeakMap;var o=Object.freeze({__proto__:null,setTitle:function(a){return y("window.setTitle",{title:a})},getTitle:function(){return y("window.getTitle")},maximize:function(){return y("window.maximize")},unmaximize:function(){return y("window.unmaximize")},isMaximized:function(){return y("window.isMaximized")},minimize:function(){return y("window.minimize")},setFullScreen:function(){return y("window.setFullScreen")},exitFullScreen:function(){return y("window.exitFullScreen")},isFullScreen:function(){return y("window.isFullScreen")},show:function(){return y("window.show")},hide:function(){return y("window.hide")},isVisible:function(){return y("window.isVisible")},focus:function(){return y("window.focus")},setIcon:function(a){return y("window.setIcon",{icon:a})},move:function(a,b){return y("window.move",{x:a,y:b})},setDraggableRegion:function(a){return new Promise((f,c)=>{let b=a instanceof Element?a:document.getElementById(a),g=0,h=0;if(!b)return c({code:"NE_WD_DOMNOTF",message:"Unable to find DOM element"});if(E.has(b))return c({code:"NE_WD_ALRDREL",message:"This DOM element is already an active draggable region"});function i(a){return t(this,void 0,void 0,function*(){yield Neutralino.window.move(a.screenX-g,a.screenY-h)})}function d(a){0===a.button&&(g=a.clientX,h=a.clientY,b.addEventListener("pointermove",i),b.setPointerCapture(a.pointerId))}function e(a){b.removeEventListener("pointermove",i),b.releasePointerCapture(a.pointerId)}b.addEventListener("pointerdown",d),b.addEventListener("pointerup",e),E.set(b,{pointerdown:d,pointerup:e}),f({success:!0,message:"Draggable region was activated"})})},unsetDraggableRegion:function(a){return new Promise((d,c)=>{let b=a instanceof Element?a:document.getElementById(a);if(!b)return c({code:"NE_WD_DOMNOTF",message:"Unable to find DOM element"});if(!E.has(b))return c({code:"NE_WD_NOTDRRE",message:"DOM element is not an active draggable region"});let{pointerdown:e,pointerup:f}=E.get(b);b.removeEventListener("pointerdown",e),b.removeEventListener("pointerup",f),E.delete(b),d({success:!0,message:"Draggable region was deactivated"})})},setSize:function(a){return new Promise((b,c)=>t(this,void 0,void 0,function*(){let d=yield Neutralino.window.getSize();a=Object.assign(Object.assign({},d),a),y("window.setSize",a).then(a=>{b(a)}).catch(a=>{c(a)})}))},getSize:function(){return y("window.getSize")},getPosition:function(){return y("window.getPosition")},setAlwaysOnTop:function(a){return y("window.setAlwaysOnTop",{onTop:a})},create:function(a,b){return new Promise((g,h)=>{function e(a){return"string"!=typeof a||(a=a.trim()).includes(" ")&&(a=`"${a}"`),a}let c=window.NL_ARGS.reduce((b,a,c)=>((a.includes("--path=")||a.includes("--debug-mode")||a.includes("--load-dir-res")||0==c)&&(b+=" "+e(a)),b),"");for(let d in c+=" --url="+e(a),b){if("processArgs"==d)continue;let f=d.replace(/[A-Z]|^[a-z]/g,a=>"-"+a.toLowerCase());c+=` --window${f}=${e(b[d])}`}b&&b.processArgs&&(c+=" "+b.processArgs),Neutralino.os.execCommand(c,{background:!0}).then(a=>{g(a)}).catch(a=>{h(a)})})}}),p=Object.freeze({__proto__:null,broadcast:function(a,b){return y("events.broadcast",{event:a,data:b})},on:function(a,b){return window.addEventListener(a,b),Promise.resolve({success:!0,message:"Event listener added"})},off:function(a,b){return window.removeEventListener(a,b),Promise.resolve({success:!0,message:"Event listener removed"})},dispatch:h}),q=Object.freeze({__proto__:null,dispatch:function(a,b,c){return new Promise((d,e)=>t(this,void 0,void 0,function*(){let h=yield Neutralino.extensions.getStats();if(h.loaded.includes(a)){if(h.connected.includes(a))try{let i=yield y("extensions.dispatch",{extensionId:a,event:b,data:c});d(i)}catch(j){e(j)}else{var f,g;f=a,g={method:"extensions.dispatch",data:{extensionId:a,event:b,data:c},resolve:d,reject:e},f in x?x[f].push(g):x[f]=[g]}}else e({code:"NE_EX_EXTNOTL",message:`${a} is not loaded`})}))},broadcast:function(a,b){return y("extensions.broadcast",{event:a,data:b})},getStats:function(){return y("extensions.getStats")}});let F=null;var r=Object.freeze({__proto__:null,checkForUpdates:function(a){return new Promise((b,c)=>t(this,void 0,void 0,function*(){if(!a)return c({code:"NE_RT_NATRTER",message:"Missing require parameter: url"});try{var d;let e=yield fetch(a);((d=F=JSON.parse((yield e.text()))).applicationId&&d.applicationId==window.NL_APPID&&d.version&&d.resourcesURL?0:1)?c({code:"NE_UP_CUPDMER",message:"Invalid update manifest or mismatching applicationId"}):b(F)}catch(f){c({code:"NE_UP_CUPDERR",message:"Unable to fetch update manifest"})}}))},install:function(){return new Promise((a,b)=>t(this,void 0,void 0,function*(){if(!F)return b({code:"NE_UP_UPDNOUF",message:"No update manifest loaded"});try{yield Neutralino.filesystem.writeBinaryFile(window.NL_PATH+"/resources.neu",(yield(yield fetch(F.resourcesURL)).arrayBuffer())),a({success:!0,message:"Update installed. Restart the process to see updates"})}catch(c){b({code:"NE_UP_UPDINER",message:"Update installation error"})}}))}}),s=Object.freeze({__proto__:null,readText:function(a,b){return y("clipboard.readText",{key:a,data:b})},writeText:function(a){return y("clipboard.writeText",{data:a})}});let G=!1;return a.app=n,a.clipboard=s,a.computer=k,a.debug=m,a.events=p,a.extensions=q,a.filesystem=i,a.init=function(){G||(window.NL_TOKEN&&sessionStorage.setItem("NL_TOKEN",window.NL_TOKEN),u=new WebSocket(`ws://${window.location.hostname}:${window.NL_PORT}`),function(){Neutralino.events.on("ready",()=>t(this,void 0,void 0,function*(){if(yield A(w),!window.NL_EXTENABLED)return;let a=yield Neutralino.extensions.getStats();for(let b of a.connected)h("extensionReady",b)})),Neutralino.events.on("extClientConnect",a=>{h("extensionReady",a.detail)}),window.NL_EXTENABLED&&Neutralino.events.on("extensionReady",a=>t(this,void 0,void 0,function*(){a.detail in x&&(yield A(x[a.detail]),delete x[a.detail])}))}(),function(){u.addEventListener("message",d=>{var b,c;let a=JSON.parse(d.data);a.id&&a.id in v?((null===(b=a.data)|| void 0===b?void 0:b.error)?(v[a.id].reject(a.data.error),"NE_RT_INVTOKN"==a.data.error.code&&(u.close(),document.body.innerText="",document.write("<code>NE_RT_INVTOKN</code>: Neutralinojs application configuration prevents accepting native calls from this client."))):(null===(c=a.data)|| void 0===c?void 0:c.success)&&v[a.id].resolve(a.data.hasOwnProperty("returnValue")?a.data.returnValue:a.data),delete v[a.id]):a.event&&h(a.event,a.data)}),u.addEventListener("open",a=>t(this,void 0,void 0,function*(){h("ready")})),u.addEventListener("close",a=>t(this,void 0,void 0,function*(){h("serverOffline",{code:"NE_CL_NSEROFF",message:"Neutralino server is offline. Try restarting the application"})}))}(),window.NL_ARGS.find(a=>"--neu-dev-auto-reload"==a)&&Neutralino.events.on("neuDev_reloadApp",()=>t(this,void 0,void 0,function*(){yield Neutralino.debug.log("Reloading the application..."),location.reload()})),window.NL_CVERSION="3.4.0",window.NL_CCOMMIT="4f36ae73290a69c509bc562e32b69100b6e5b4eb",G=!0)},a.os=j,a.storage=l,a.updater=r,a.window=o,Object.defineProperty(a,"__esModule",{value:!0}),a}({})
